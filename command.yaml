# This file is the SINGLE SOURCE OF TRUTH for both commands AND NLP rules.

get_status:
  - keywords: [ "interface", "interfaces", "port", "ports" ]
    entities:
      KEYWORD: [ "interface", "port" ] # Define entities for the NLP layer
    command: "show ip interface brief"
    description: "Checks the status and IP address of all interfaces."

  - keywords: [ "vlan", "vlans" ]
    entities:
      PROTOCOL: [ "vlan" ]
    command: "show vlan brief"
    description: "Displays a summary of all configured VLANs."

  - keywords: [ "version", "uptime", "serial" ]
    entities:
      KEYWORD: [ "version", "uptime" ]
    command: "show version"
    description: "Shows the device's software version, uptime, and serial number."

  - keywords: [ "bgp" ]
    entities:
      PROTOCOL: [ "bgp" ]
    command: "show ip bgp summary"
    description: "Displays the status of BGP neighbors."

  - keywords: [ "log", "logs" ]
    entities:
      KEYWORD: [ "log" ]
    command: "show logging"
    description: "Displays the device's local log buffer."

  - keywords: [ "interface status" ]
    entities:
      KEYWORD: [ "interface", "status" ]
    command: "show interface status"
    description: "Displays the status of switch interfaces."

  - keywords: [ "ospf" ]
    entities:
      PROTOCOL: [ "ospf" ]
    command: "show ip ospf neighbor"
    description: "Displays OSPF neighbor information."

  - keywords: [ "mac", "table", "mac table" ]
    entities:
      PROTOCOL: [ "mac" ]
    command: "show mac address-table"
    description: "Displays the MAC address table."

  - keywords: [ "arp", "table", "arp table" ]
    entities:
      PROTOCOL: [ "arp" ]
    command: "show ip arp"
    description: "Displays the ARP table."

  - keywords: [ "route", "routing" ]
    entities:
      PROTOCOL: [ "route" ]
    command: "show ip route"
    description: "Displays the IP routing table."

  - keywords: [ "cdp", "lldp" ]
    entities:
      PROTOCOL: [ "cdp", "lldp" ]
    command: "show cdp neighbors"
    description: "Displays CDP neighbor information."

  - default: "show version"

get_config:
  - keywords: [ "interface", "interfaces", "config", "configuration", "running-config", "startup-config" ]
    entities:
      KEYWORD: [ "interface", "config" ]
    command: "show running-config interface {interface_name}" # Placeholder for future enhancement
    description: "Displays the running configuration for a specific interface."

  - keywords: [ "vlan", "vlans", "config", "configuration" ]
    entities:
      PROTOCOL: [ "vlan" ]
      KEYWORD: [ "config" ]
    command: "show running-config | section vlan {vlan_id}"
    description: "Displays the configuration for a specific VLAN."

  - keywords: [ "route", "routing", "config", "configuration" ]
    entities:
      PROTOCOL: [ "route" ]
      KEYWORD: [ "config" ]
    command: "show running-config | section router"
    description: "Displays routing configuration."

  - keywords: [ "bgp", "config", "configuration" ]
    entities:
      PROTOCOL: [ "bgp" ]
      KEYWORD: [ "config" ]
    command: "show running-config | section router bgp"
    description: "Displays BGP configuration."

  - keywords: [ "ospf", "config", "configuration" ]
    entities:
      PROTOCOL: [ "ospf" ]
      KEYWORD: [ "config" ]
    command: "show running-config | section router ospf"
    description: "Displays OSPF configuration."

  - default: "show running-config"

find_device:
  - keywords: [ "find", "list", "search", "which devices", "all devices" ]
    entities:
      KEYWORD: [ "find", "list", "search", "which" ]
    command: "show inventory"
    description: "Find and list network devices."

  - keywords: [ "arp", "table", "arp table", "devices", "connected" ]
    entities:
      PROTOCOL: [ "arp" ]
      KEYWORD: [ "arp", "devices" ]
    command: "show ip arp"
    description: "Show devices connected based on ARP table."

  - keywords: [ "cdp", "lldp", "neighbors", "connected", "devices" ]
    entities:
      PROTOCOL: [ "cdp", "lldp" ]
      KEYWORD: [ "neighbors", "devices" ]
    command: "show cdp neighbors"
    description: "Show connected neighboring devices via CDP."


greeting:
  - keywords: [ "hello", "hi", "hey", "greetings" ]
    entities:
      KEYWORD: [ "hello", "hi" ]
    command: "echo Hello! How can I help you?"
    description: "Greeting response."

# We can also define entities that don't map to a specific command
# but are important for the NLP layer to recognize.
global_entities:
  PROTOCOL: [ "ospf", "eigrp", "spanning-tree", "stp", "bgp", "rip", "isis", "mpls", "vlan", "vtp", "stp", "hsrp", "vrrp", "glbp", "dhcp", "dns" ]
  KEYWORD: [ "flaps", "errors", "config", "down", "up", "critical", "warning", "interface", "port", "status", "running", "startup", "neighbor", "route", "routing", "mac", "arp", "cdp", "lldp", "trunk", "access" ]

# New section for the on-demand analysis feature
health_checks:
  - command: "show ip interface brief"
    description: "Monitor for interface status changes (up/down)."
  - command: "show processes cpu sorted | include one minute"
    description: "Monitor for high CPU utilization."
  - command: "show memory statistics"
    description: "Monitor for low memory conditions."